<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div th:replace="~{fragments/header :: headerFragment}"></div>
<body>
<main>
    <nav th:replace="~{fragments/sidebar :: sidebarFragment}"></nav>
    <section class="content">
        <div class="left-content">
            <div class="activities">
                <h1>꿀팁 관리</h1>
                <div>
                    <form id="actionForm" th:action="@{/admin/pro-tips}" th:object="${condition}" method="get">
                        <div class="form-row">

                            <label for="proTipType">꿀팁 종류:</label>
                            <select id="proTipType" name="proTipType">
                                <option value="">전체</option>
                                <option th:each="proTipType : ${T(b172.challenging.protip.domain.ProTipType).values()}"
                                        th:value="${proTipType}" th:text="${proTipType.getKey()}"
                                        th:selected="${condition.proTipType() eq proTipType}"/>
                            </select>

                            <label for="useYn">사용 여부:</label>
                            <select id="useYn" name="useYn">
                                <option value="">전체</option>
                                <option th:each="useYn : ${T(b172.challenging.common.domain.UseYn).values()}"
                                        th:value="${useYn}" th:text="${useYn}"
                                        th:selected="${condition.useYn() eq useYn}"/>
                            </select>
                        </div>

                        <!-- 두 번째 라인: 검색조건(셀렉트박스), 검색 내용(쿼리) -->
                        <div th:class="form-row">
                            <label for="searchCriteria">검색조건:</label>
                            <select id="searchCriteria" name="searchCriteria">
                                <option value="">전체</option>
                                <option th:value="nickname"
                                        th:text="닉네임"
                                        th:selected="${condition.searchCriteria() eq 'nickname'}" />
                                <option th:value="title"
                                        th:text="제목"
                                        th:selected="${condition.searchCriteria() eq 'title'}" />
                            </select>

                            <label for="searchQuery">검색 내용:</label>
                            <input type="text" id="searchQuery" name="searchQuery" th:value="*{searchQuery}" placeholder="Search Query" />

                            <button th:type="button" th:onclick="'submitFormWithAction(\'' + @{/admin/pro-tips} + '\'' + ')'">검색</button>

                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                            <input type="hidden" name="page" id="page" value="0" />
                            <input type="hidden" name="size" id="size" value="5" />
                        </div>
                    </form>
                    <br>
                    <label th:text="'총 ' + ${proTips.totalElements} + ' 건'"/>
                    <div class="right-align">
                        <button th:onclick="'window.location.href=\'' + @{/admin/pro-tips/create} + '\''">꿀팁 생성</button>
                    </div>
                    <table>
                        <caption>회원 관리</caption>
                        <thead>
                        <tr>
                            <th>번호</th>
                            <th>컨텐츠타입</th>
                            <th>제목</th>
                            <th>등록자</th>
                            <th>등록일</th>
                            <th>사용여부</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr  th:if="${!proTips.list().isEmpty()}" th:each="proTip : ${proTips.list()}">
                            <td><a th:href="@{/admin/pro-tips/{id}(id=${proTip.id})}" th:text="${proTip.id}"/></td>
                            <td th:text="${proTip.proTipType().getKey()}"/>
                            <td th:text="${proTip.title}"/>
                            <td th:text="${proTip.registerId.nickname}"/>
                            <td th:text="${#temporals.format((proTip.updatedAt == null ? proTip.createdAt : proTip.updatedAt),'yyyy-MM-dd HH:mm')}"/>
                            <td th:text="${proTip.useYn}"/>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="left-bottom">
                <div class="pagination" th:if="${proTips.totalPages > 1}">
                    <div th:if="${proTips.hasPrevious()}">
                        <button th:type="button" th:onclick="'movePage(\''+ ${proTips.number - 1} + '\'' + ')'" class="prev">&#10094; Previous</button>
                    </div>
                    <div th:each="currPage : ${#numbers.sequence((proTips.totalPages < 5 ? 0 : proTips.totalPages - 5), proTips.totalPages - 1)}">
                        <button th:type="button" th:onclick="'movePage(\''+ ${currPage} +'\'' + ')'" th:class="${proTips.number == currPage ? 'active' : ''}" th:text="${currPage + 1}"/>
                    </div>
                    <div th:if="${proTips.hasNext()}">
                        <button th:type="button" th:onclick="'movePage(\''+ ${proTips.number + 1} +'\'' + ')'" class="next">Next &#10095;</button>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>
</body>
</html>
